<?php
/**
 * Plugin Name: PageSpeed Optimizer
 * Description: Make website faster, speed up page load time and improve performance scores in services like GTmetrix, Pingdom, YSlow and PageSpeed.
 * Version: 2.0.1
 * License: GPL2
*/
 class MMR_Encoding { const ICONV_TRANSLIT = "TRANSLIT"; const ICONV_IGNORE = "IGNORE"; const WITHOUT_ICONV = ""; protected static $win1252ToUtf8 = array(128 => "â‚¬", 130 => "â€š", 131 => "Æ’", 132 => "â€ž", 133 => "â€¦", 134 => "â€ ", 135 => "â€¡", 136 => "Ë†", 137 => "â€°", 138 => "Å ", 139 => "â€¹", 140 => "Å’", 142 => "Å½", 145 => "â€˜", 146 => "â€™", 147 => "â€œ", 148 => "â€", 149 => "â€¢", 150 => "â€“", 151 => "â€”", 152 => "Ëœ", 153 => "â„¢", 154 => "Å¡", 155 => "â€º", 156 => "Å“", 158 => "Å¾", 159 => "Å¸"); protected static $brokenUtf8ToUtf8 = array("Â€" => "â‚¬", "Â‚" => "â€š", "Âƒ" => "Æ’", "Â„" => "â€ž", "Â…" => "â€¦", "Â†" => "â€ ", "Â‡" => "â€¡", "Âˆ" => "Ë†", "Â‰" => "â€°", "ÂŠ" => "Å ", "Â‹" => "â€¹", "ÂŒ" => "Å’", "ÂŽ" => "Å½", "Â‘" => "â€˜", "Â’" => "â€™", "Â“" => "â€œ", "Â”" => "â€", "Â•" => "â€¢", "Â–" => "â€“", "Â—" => "â€”", "Â˜" => "Ëœ", "Â™" => "â„¢", "Âš" => "Å¡", "Â›" => "â€º", "Âœ" => "Å“", "Âž" => "Å¾", "ÂŸ" => "Å¸"); protected static $utf8ToWin1252 = array("â‚¬" => "€", "â€š" => "‚", "Æ’" => "ƒ", "â€ž" => "„", "â€¦" => "…", "â€ " => "†", "â€¡" => "‡", "Ë†" => "ˆ", "â€°" => "‰", "Å " => "Š", "â€¹" => "‹", "Å’" => "Œ", "Å½" => "Ž", "â€˜" => "‘", "â€™" => "’", "â€œ" => "“", "â€" => "”", "â€¢" => "•", "â€“" => "–", "â€”" => "—", "Ëœ" => "˜", "â„¢" => "™", "Å¡" => "š", "â€º" => "›", "Å“" => "œ", "Å¾" => "ž", "Å¸" => "Ÿ"); static function toUTF8($text) { goto WIqxp; kPjeK: $max = self::strlen($text); goto L82Ls; OuAC5: if ($c1 >= "À") { goto q2aEK; } goto nocls; h_dbk: foreach ($text as $k => $v) { $text[$k] = self::toUTF8($v); FESYY: } goto qVUB8; Pm7W1: GtROO: goto rnWfy; HV0Yq: $cc1 = chr(ord($c1) / 64) | "À"; goto dwuVR; xrkOP: $buf .= $cc1 . $cc2; goto b3orH; pc0_S: $i = $i + 2; goto zVhdY; Yggzq: goto UMZKS; goto KklM9; b3orH: goto q2_dM; goto ziotW; T8SA2: $i = $i + 3; goto T4tU0; F4ZWd: $i++; goto Yggzq; ytgCZ: goto iG1US; goto Pm7W1; vvL3c: $buf .= $cc1 . $cc2; goto cwb6C; iHpff: $c2 = $i + 1 >= $max ? "\0" : $text[$i + 1]; goto ys9r8; ys9r8: $c3 = $i + 2 >= $max ? "\0" : $text[$i + 2]; goto bD04e; i_Wm5: if (!($i < $max)) { goto pk6hE; } goto gUS1k; gUS1k: $c1 = $text[$i]; goto OuAC5; jYIxc: if ($c1 >= "ð" & $c1 <= "÷") { goto GmyRy; } goto s9kw3; nocls: if (($c1 & "À") === "€") { goto DghMj; } goto xgcwv; bD04e: $c4 = $i + 3 >= $max ? "\0" : $text[$i + 3]; goto D585N; vidIM: jh7ls: goto F4ZWd; F4E1S: goto oMRP_; goto wK0d1; Rgc8o: g4jE1: goto A9Yzd; Z1l2X: t_Lpq: goto zDBIU; MloU6: $buf .= $cc1 . $cc2; goto AGFRf; wK0d1: GmyRy: goto s3xmb; A9Yzd: goto oMRP_; goto DWMkL; xgcwv: $buf .= $c1; goto JE2lK; pTeqQ: $buf .= $cc1 . $cc2; goto ytgCZ; ziotW: hEYGF: goto ToBdx; LkMHe: if (is_string($text)) { goto g3gsD; } goto q2j_g; rnWfy: $buf .= self::$win1252ToUtf8[ord($c1)]; goto yXO1Q; TE94U: B47vU: goto LkMHe; AGFRf: goto g4jE1; goto Z1l2X; yXO1Q: iG1US: goto ObCew; DWMkL: exrGF: goto IhTOX; WIqxp: if (!is_array($text)) { goto B47vU; } goto h_dbk; ObCew: VQXuD: goto vidIM; qVUB8: E60xc: goto mEBxc; a_TK1: $cc2 = $c1 & "?" | "€"; goto xrkOP; T4tU0: bAWLd: goto R_2Mw; pl7zl: g3gsD: goto kPjeK; Eh8bZ: $cc2 = $c1 & "?" | "€"; goto pTeqQ; KecLG: $i = 0; goto l2iqi; cwb6C: goto oMRP_; goto kkjc8; ZuDoX: return $buf; goto j7szH; D585N: if ($c1 >= "À" & $c1 <= "ß") { goto r0lta; } goto wPjqx; wPjqx: if ($c1 >= "à" & $c1 <= "ï") { goto exrGF; } goto jYIxc; zDBIU: $buf .= $c1 . $c2; goto kMkYT; KklM9: pk6hE: goto ZuDoX; VE79x: MwcGf: goto murQh; dwuVR: $cc2 = $c1 & "?" | "€"; goto MloU6; T2XCr: $cc1 = chr(ord($c1) / 64) | "À"; goto a_TK1; JE2lK: goto VQXuD; goto beSlg; kkjc8: r0lta: goto dVVp6; LksiI: $cc1 = chr(ord($c1) / 64) | "À"; goto Eh8bZ; ZO0IW: $cc1 = chr(ord($c1) / 64) | "À"; goto a6wJZ; dVVp6: if ($c2 >= "€" && $c2 <= "¿") { goto t_Lpq; } goto HV0Yq; L82Ls: $buf = ""; goto KecLG; yp_Re: goto bAWLd; goto VE79x; q2j_g: return $text; goto pl7zl; l2iqi: UMZKS: goto i_Wm5; N5ANE: $cc2 = $c1 & "?" | "€"; goto vvL3c; RQiwV: goto VQXuD; goto Cuz3R; DTh_U: if (isset(self::$win1252ToUtf8[ord($c1)])) { goto GtROO; } goto LksiI; Cuz3R: DghMj: goto DTh_U; R_2Mw: oMRP_: goto RQiwV; s3xmb: if ($c2 >= "€" && $c2 <= "¿" && $c3 >= "€" && $c3 <= "¿" && $c4 >= "€" && $c4 <= "¿") { goto MwcGf; } goto ZO0IW; s9kw3: $cc1 = chr(ord($c1) / 64) | "À"; goto N5ANE; kMkYT: $i++; goto Rgc8o; murQh: $buf .= $c1 . $c2 . $c3 . $c4; goto T8SA2; ToBdx: $buf .= $c1 . $c2 . $c3; goto pc0_S; zVhdY: q2_dM: goto F4E1S; NrFJH: $buf .= $cc1 . $cc2; goto yp_Re; mEBxc: return $text; goto TE94U; beSlg: q2aEK: goto iHpff; IhTOX: if ($c2 >= "€" && $c2 <= "¿" && $c3 >= "€" && $c3 <= "¿") { goto hEYGF; } goto T2XCr; a6wJZ: $cc2 = $c1 & "?" | "€"; goto NrFJH; j7szH: } static function toWin1252($text, $option = self::WITHOUT_ICONV) { goto kV87h; U0ntB: return static::utf8_decode($text, $option); goto GQIXA; v01TG: dh4PX: goto U0ntB; GQIXA: VsymI: goto Hd5MN; iHptH: if (is_string($text)) { goto dh4PX; } goto lkQ8n; kV87h: if (is_array($text)) { goto Lr5lO; } goto iHptH; hfwr7: foreach ($text as $k => $v) { $text[$k] = self::toWin1252($v, $option); GMYH0: } goto jfj8g; JmmP_: goto VsymI; goto v01TG; ET3SR: goto VsymI; goto vd9CU; vLE9e: return $text; goto JmmP_; jfj8g: SLRI0: goto vLE9e; vd9CU: Lr5lO: goto hfwr7; lkQ8n: return $text; goto ET3SR; Hd5MN: } static function toISO8859($text, $option = self::WITHOUT_ICONV) { return self::toWin1252($text, $option); } static function toLatin1($text, $option = self::WITHOUT_ICONV) { return self::toWin1252($text, $option); } static function fixUTF8($text, $option = self::WITHOUT_ICONV) { goto Madc9; taD7N: YK6in: goto H92vh; dfW5l: ZSyAf: goto CQb2n; sMG_X: SeIGE: goto fnk16; Kix58: if (is_string($text)) { goto YK6in; } goto XXbT7; VkkJ3: $text = self::toUTF8(static::utf8_decode($text, $option)); goto gXF0x; Madc9: if (!is_array($text)) { goto WyFk2; } goto m7cS5; H92vh: $last = ""; goto sMG_X; vglF4: $text = self::toUTF8(static::utf8_decode($text, $option)); goto saLs5; CQb2n: return $text; goto tFatH; saLs5: return $text; goto Oe73o; gXF0x: goto SeIGE; goto LD7az; fnk16: if (!($last != $text)) { goto bycYB; } goto r6FU3; r6FU3: $last = $text; goto VkkJ3; tFatH: WyFk2: goto Kix58; XXbT7: return $text; goto taD7N; LD7az: bycYB: goto vglF4; m7cS5: foreach ($text as $k => $v) { $text[$k] = self::fixUTF8($v, $option); HIYEx: } goto dfW5l; Oe73o: } static function UTF8FixWin1252Chars($text) { return str_replace(array_keys(self::$brokenUtf8ToUtf8), array_values(self::$brokenUtf8ToUtf8), $text); } static function removeBOM($str = "") { goto yeu1K; QcWsS: NBus6: goto AV6Qq; Tnr6c: $str = substr($str, 3); goto QcWsS; AV6Qq: return $str; goto jYERG; yeu1K: if (!(substr($str, 0, 3) === pack("CCC", 0xef, 0xbb, 0xbf))) { goto NBus6; } goto Tnr6c; jYERG: } protected static function strlen($text) { return function_exists('mb_strlen') && (int) ini_get('mbstring.func_overload') & 2 ? mb_strlen($text, '8bit') : strlen($text); } public static function normalizeEncoding($encodingLabel) { goto HkvDl; qdYpP: $encoding = preg_replace('/[^a-zA-Z0-9\\s]/', '', $encoding); goto JbVNT; AxJZM: DF3d4: goto Zi8Y1; HkvDl: $encoding = strtoupper($encodingLabel); goto qdYpP; X6K0D: if (!empty($equivalences[$encoding])) { goto DF3d4; } goto JvOV_; JvOV_: return 'UTF-8'; goto AxJZM; Zi8Y1: return $equivalences[$encoding]; goto G8dtO; JbVNT: $equivalences = array('ISO88591' => 'ISO-8859-1', 'ISO8859' => 'ISO-8859-1', 'ISO' => 'ISO-8859-1', 'LATIN1' => 'ISO-8859-1', 'LATIN' => 'ISO-8859-1', 'UTF8' => 'UTF-8', 'UTF' => 'UTF-8', 'WIN1252' => 'ISO-8859-1', 'WINDOWS1252' => 'ISO-8859-1'); goto X6K0D; G8dtO: } public static function encode($encodingLabel, $text) { goto Wu1ho; CB9ai: if (!($encodingLabel === 'ISO-8859-1')) { goto wC_VI; } goto t6w2h; BBItI: wC_VI: goto LL2Sx; t6w2h: return self::toLatin1($text); goto BBItI; LL2Sx: return self::toUTF8($text); goto rUjqF; Wu1ho: $encodingLabel = self::normalizeEncoding($encodingLabel); goto CB9ai; rUjqF: } protected static function utf8_decode($text, $option = self::WITHOUT_ICONV) { goto pnrVw; z1mgP: $o = iconv("UTF-8", "Windows-1252" . ($option === self::ICONV_TRANSLIT ? '//TRANSLIT' : ($option === self::ICONV_IGNORE ? '//IGNORE' : '')), $text); goto Y238h; umfRZ: $o = utf8_decode(str_replace(array_keys(self::$utf8ToWin1252), array_values(self::$utf8ToWin1252), self::toUTF8($text))); goto NU3K_; p5fr9: j4TuD: goto umfRZ; NU3K_: N7dE_: goto qajno; Y238h: goto N7dE_; goto p5fr9; pnrVw: if ($option == self::WITHOUT_ICONV || !function_exists('iconv')) { goto j4TuD; } goto z1mgP; qajno: return $o; goto fnRCw; fnRCw: } }